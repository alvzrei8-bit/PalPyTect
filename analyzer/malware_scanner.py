import hashlib
import os

class MalwareScanner:
    # Heuristic signatures for common malicious patterns
    BAD_PATTERNS = [b'os.system("rm -rf /")', b'subprocess.Popen', b'requests.post("http']

    @staticmethod
    def scan(file_path):
        if not os.path.exists(file_path):
            raise FileNotFoundError("Input file missing.")
        
        with open(file_path, 'rb') as f:
            content = f.read()
            
        # 1. Signature Check
        for pattern in MalwareScanner.BAD_PATTERNS:
            if pattern in content:
                return False
        
        # 2. Basic Hash check (expandable list)
        f_hash = hashlib.sha256(content).hexdigest()
        if f_hash in ["e3b0c442..."]: # Add known malware hashes here
            return False
            
        return True
      
